<div class="container">
    
    <p class="text-center mb-3">
        <img src="/assets/images/logo-blue.png" width="250">
    </p>

    <h1 id="title" class="title">Alterar a senha</h1>
    <p class="sub-title">Por favor, defina uma nova senha</p>

    <nb-alert *ngIf="showMessages.error && errors?.length && !submitted" outline="danger" role="alert">
        <p class="alert-title"><b>Oh snap!</b></p>
        <ul class="alert-message-list">
            <li *ngFor="let error of errors" class="alert-message">{{ error }}</li>
        </ul>
    </nb-alert>

    <nb-alert *ngIf="showMessages.success && messages?.length && !submitted" outline="success" role="alert">
        <p class="alert-title"><b>Hooray!</b></p>
        <ul class="alert-message-list">
            <li *ngFor="let message of messages" class="alert-message">{{ message }}</li>
        </ul>
    </nb-alert>

    <form (ngSubmit)="resetPass()" #resetPassForm="ngForm" aria-labelledby="title">

        <div class="form-control-group">
            <label class="label" for="input-senha">Nova Senha:</label>
            <input nbInput [(ngModel)]="user.senha" #senha="ngModel" type="senha" id="input-senha"
                name="senha" class="first" placeholder="Nova senha" autofocus fullWidth fieldSize="large"
                [status]="senha.dirty ? (senha.invalid  ? 'danger' : 'success') : 'basic'"
                [required]="getConfigValue('forms.validation.senha.required')"
                [minlength]="getConfigValue('forms.validation.senha.minLength')"
                [maxlength]="getConfigValue('forms.validation.senha.maxLength')"
                [attr.aria-invalid]="senha.invalid && senha.touched ? true : null">
            <ng-container *ngIf="senha.invalid && senha.touched">
                <p class="caption status-danger" *ngIf="senha.errors">
                    senha is required!
                </p>
                <p class="caption status-danger" *ngIf="senha.errors || senha.errors">
                    senha should contains
                    from {{getConfigValue('forms.validation.senha.minLength')}}
                    to {{getConfigValue('forms.validation.senha.maxLength')}}
                    characters
                </p>
            </ng-container>
        </div>

        <div class="form-group">
            <label class="label" for="input-re-senha">Confirm senha:</label>
            <input nbInput [(ngModel)]="user.confirm_senha" #rePass="ngModel" id="input-re-senha" name="rePass"
                type="senha" class="last" placeholder="Confirm senha" fullWidth fieldSize="large" [status]="rePass.touched
               ? (rePass.invalid || senha.value != rePass.value ? 'danger' : 'success')
               : 'basic'" [required]="getConfigValue('forms.validation.senha.required')"
                [attr.aria-invalid]="rePass.invalid && rePass.touched ? true : null">
            <ng-container *ngIf="rePass.touched">
                <p class="caption status-danger" *ngIf="rePass.invalid && rePass.errors">
                    senha é necessária confirmação!
                </p>
                <p class="caption status-danger" *ngIf="senha.value != rePass.value && !rePass.errors">
                    senha não corresponde à senha de confirmação.
                </p>
            </ng-container>
        </div>

        <button nbButton status="primary" fullWidth size="large" [disabled]="submitted || !resetPassForm.valid"
            [class.btn-pulse]="submitted">
            Alterar senha
        </button>
    </form>

    <section class="sign-in-or-up" aria-label="Sign in or sign up">
        <p><a class="text-link" routerLink="../login">Voltar para login</a></p>
    </section>
</div>